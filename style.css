/* Core vibrant theme & draggable + scalable panels */

:root {
  --bg:#08101c;
  --txt:#f0f6ff;
  --muted:#9fb0c6;
  --cyan:#00f2ea;
  --pink:#ff1180;
  --gold:#f7d25c;
  --bronze:#c97a32;
  --silver:#c9d2df;
  --danger:#ff5d5d;
  --good:#5df28f;
  --panel-bg:rgba(14,22,34,0.78);
  --panel-border:rgba(255,255,255,0.18);
  --shadow-strong:0 0 30px rgba(0,242,234,0.45),0 0 60px rgba(255,0,128,0.35);
  --transition:0.25s cubic-bezier(.4,.14,.3,1);
  --scale-handle-size:14px;
  --drag-bar-height:34px;
}

*{box-sizing:border-box;}

/* Background animation */
html,body,#app,#game-container{
  margin:0;padding:0;width:100%;height:100%;
  font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,Cantarell,Arial,'Noto Sans',sans-serif;
  color:var(--txt);overflow:hidden;background:#08101c;
  background-image:
    radial-gradient(1200px 800px at 15% 20%,rgba(0,242,234,0.25),transparent 70%),
    radial-gradient(1000px 750px at 85% 80%,rgba(255,0,128,0.22),transparent 72%),
    linear-gradient(140deg,#08101c,#0d1e2f 55%,#112235);
  background-blend-mode:screen,screen,normal;
  animation:bgPulse 18s linear infinite;
}
@keyframes bgPulse{
  0%,100%{filter:brightness(1) saturate(1);}
  50%{filter:brightness(1.18) saturate(1.25);}
}

#game-container{position:relative;}
#fx-canvas,#board-frame,#board-divider,#slot-tray,#board-title{position:absolute;inset:0;pointer-events:none;}
#board-frame{
  border-radius:24px;
  border:2px solid rgba(0,242,234,0.65);
  box-shadow:0 0 22px rgba(0,242,234,0.6),0 0 60px rgba(255,0,128,0.28),inset 0 0 120px rgba(0,0,0,0.55);
  background:radial-gradient(circle at 50% 20%,rgba(0,242,234,0.15),transparent 65%),linear-gradient(180deg,rgba(15,25,40,0.55),rgba(10,18,30,0.9));
}
#board-divider{
  height:2px;display:none;
  background:linear-gradient(90deg,var(--cyan),var(--pink));
  filter:drop-shadow(0 0 12px rgba(0,242,234,0.85));
  border-radius:2px;
}
#slot-tray{
  background:linear-gradient(180deg,rgba(255,0,128,0.25),rgba(255,0,128,0.38));
  border-bottom-left-radius:24px;border-bottom-right-radius:24px;
  box-shadow:inset 0 10px 24px rgba(255,0,128,0.25);
}
#tray-dividers{
  position:absolute;inset:0;
  background:repeating-linear-gradient(90deg,rgba(255,255,255,0) 0 calc(var(--slot-width,60px) - 1px),rgba(0,242,234,0.95) calc(var(--slot-width,60px) - 1px) calc(var(--slot-width,60px) + 1px),rgba(255,255,255,0) calc(var(--slot-width,60px) + 1px) calc(var(--slot-width,60px) + 2px));
  filter:drop-shadow(0 0 8px rgba(0,242,234,0.85));
}

#board-title{
  font-weight:900;letter-spacing:2px;font-size:34px;
  background:linear-gradient(90deg,#fff,#00f2ea 45%,#ff5aa0 80%);
  -webkit-background-clip:text;color:transparent;
  text-shadow:0 0 24px rgba(0,242,234,0.55),0 0 50px rgba(255,0,128,0.35);
}

#overlay{
  position:absolute;inset:0;
  display:grid;
  grid-template-columns:340px 1fr 300px;
  grid-template-rows:auto 1fr;
  gap:14px;padding:14px;
  pointer-events:none;
}

.branding{
  pointer-events:auto;
  display:flex;align-items:center;gap:12px;
  background:var(--panel-bg);
  border:1px solid var(--panel-border);
  border-radius:16px;
  padding:10px 18px;
  backdrop-filter:blur(12px) saturate(160%);
  box-shadow:0 0 18px rgba(0,242,234,0.35);
  font-size:20px;font-weight:800;
  position:relative;
}
.branding .live{font-size:14px;font-weight:700;color:var(--cyan);letter-spacing:1px;}
#controls-panel{pointer-events:auto;display:flex;align-items:center;}
#btn-gear{
  background:linear-gradient(145deg,#132536,#0f1d2c);
  color:var(--txt);border:1px solid #264063;
  border-radius:14px;padding:10px 16px;cursor:pointer;
  font-size:16px;font-weight:600;
  box-shadow:0 0 16px rgba(0,242,234,0.45);
  transition:var(--transition);
}
#btn-gear:hover{filter:brightness(1.2);transform:translateY(-2px);}

.panel{
  background:var(--panel-bg);
  border:1px solid var(--panel-border);
  border-radius:24px;
  backdrop-filter:blur(16px) saturate(170%);
  box-shadow:var(--shadow-strong);
  position:relative;
  pointer-events:auto;
}

/* Leaderboard */
#leaderboard{padding:6px 8px 14px;min-width:240px;max-width:420px;}
#leaderboard .drag-bar{
  height:var(--drag-bar-height);
  display:flex;align-items:center;
  padding:0 12px;
  font-weight:900;
  letter-spacing:1.2px;
  font-size:14px;
  background:linear-gradient(90deg,rgba(0,242,234,0.25),rgba(255,0,128,0.25));
  border-radius:18px;
  margin:4px 4px 10px;
  cursor:grab;
  position:relative;
}
.mini-hint{font-size:10px;font-weight:600;opacity:.6;margin-left:8px;letter-spacing:.5px;}

.lb-list{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:6px;max-height:60vh;overflow:auto;}
.lb-item{
  display:grid;grid-template-columns:52px 1fr auto;align-items:center;
  gap:12px;padding:8px 10px;
  background:linear-gradient(140deg,rgba(255,255,255,0.10),rgba(255,255,255,0.03));
  border:1px solid rgba(255,255,255,0.12);
  border-radius:14px;
  font-size:14px;
  transition:var(--transition);
}
.lb-item:hover{filter:brightness(1.2);}
.lb-ava{width:52px;height:52px;border-radius:50%;background:#0f1b2e center/cover no-repeat;box-shadow:0 0 0 2px #0b1426,0 0 0 3px rgba(0,242,234,0.9),0 0 12px rgba(0,242,234,0.55);}
.lb-name{font-weight:700;}
.lb-score{color:var(--cyan);font-weight:900;text-shadow:0 0 12px rgba(0,242,234,0.7);}

/* Slot labels */
#slot-labels{position:absolute;left:0;right:0;bottom:0;display:flex;gap:6px;padding:10px 12px;}
.slot-label{
  flex:1;display:flex;align-items:center;justify-content:center;height:46px;
  font-size:18px;font-weight:900;border-radius:14px;
  background:linear-gradient(180deg,rgba(255,255,255,0.18),rgba(255,255,255,0.05));
  letter-spacing:.6px;box-shadow:0 0 0 1px rgba(255,255,255,0.1),inset 0 0 10px rgba(0,0,0,0.6),0 0 16px rgba(0,242,234,0.22);
  text-shadow:0 0 6px rgba(0,0,0,0.8),0 0 10px rgba(255,255,255,0.35);
  transition:var(--transition);
}
.slot-label:hover{transform:translateY(-6px) scale(1.1);filter:brightness(1.25);}
.slot-label.mult-top{background:linear-gradient(180deg,#8a6100,#2c1f00);color:#ffe59a;}
.slot-label.mult-high{background:linear-gradient(180deg,#006571,#00242a);color:#c6ffff;}
.slot-label.mult-mid{background:linear-gradient(180deg,#7c0063,#2a001f);color:#ffc5f3;}
.slot-label.mult-low{background:linear-gradient(180deg,#6f3900,#251300);color:#ffcda1;}
.slot-label.mult-base{background:linear-gradient(180deg,#1d2f44,#0d1824);color:#d0dceb;}

#right-stack{grid-row:2;grid-column:3;display:flex;flex-direction:column;gap:18px;pointer-events:none;}
#reward-teasers{
  pointer-events:auto;
  background:var(--panel-bg);
  border:1px solid var(--panel-border);
  border-radius:20px;
  padding:8px 12px;
  backdrop-filter:blur(14px) saturate(160%);
  box-shadow:0 0 20px rgba(0,242,234,0.35);
  position:relative;
}
.teaser-hint{text-align:center;font-size:13px;font-weight:600;color:var(--muted);}

/* Commands Panel */
#commands-panel{
  pointer-events:auto;
  background:var(--panel-bg);
  border:1px solid var(--panel-border);
  border-radius:28px;
  padding:16px 18px 28px;
  position:relative;
  backdrop-filter:blur(18px) saturate(170%);
  box-shadow:var(--shadow-strong);
  width:340px;
}
#commands-panel .resize-handle{right:4px;bottom:4px;}
.cmd-title{
  font-weight:900;font-size:24px;letter-spacing:2px;text-align:center;margin:0 0 14px;
  background:linear-gradient(90deg,#fff,#00f2ea 45%,#ff5aa0 80%);
  -webkit-background-clip:text;color:transparent;
  text-shadow:0 0 16px rgba(0,242,234,0.55),0 0 34px rgba(255,0,128,0.45);
  cursor:grab;
}
.cmd-section{margin-bottom:16px;}
.cmd-section-title{
  margin:0 0 8px;font-size:11px;font-weight:800;letter-spacing:2px;color:#c2d4e5;display:flex;align-items:center;gap:8px;
}
.cmd-section-title::after{content:'';flex:1;height:1px;background:linear-gradient(90deg,rgba(255,255,255,.2),rgba(255,255,255,0));}
.cmd-list{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:8px;}
.cmd-line{
  display:flex;align-items:center;gap:10px;
  background:linear-gradient(140deg,rgba(255,255,255,0.1),rgba(255,255,255,0.03));
  padding:10px 12px;border-radius:14px;position:relative;
  border:1px solid rgba(255,255,255,0.15);backdrop-filter:blur(6px);
  transition:var(--transition);cursor:default;
}
.cmd-line:hover{filter:brightness(1.25);transform:translateY(-3px);}
.cmd-line.tier-t3{box-shadow:0 0 0 1px rgba(247,210,92,.55),0 0 22px rgba(247,210,92,.55);}
.cmd-line.tier-t2{box-shadow:0 0 0 1px rgba(191,196,206,.55),0 0 18px rgba(191,196,206,.5);}
.cmd-line.tier-t1{box-shadow:0 0 0 1px rgba(201,122,50,.55),0 0 18px rgba(201,122,50,.5);}
.cmd-line.neutral{box-shadow:0 0 0 1px rgba(0,242,234,.45),0 0 16px rgba(0,242,234,.45);}
.cmd-badge{font-weight:900;font-size:18px;letter-spacing:1px;min-width:56px;text-align:center;background:linear-gradient(90deg,#fff,#00f2ea 45%,#ff5aa0 80%);-webkit-background-clip:text;color:transparent;filter:drop-shadow(0 0 6px rgba(0,242,234,0.65));}
.cmd-badge.small{font-size:14px;min-width:70px;}
.cmd-text{font-size:14px;font-weight:600;flex:1;color:#eaf5ff;letter-spacing:.4px;}
.gift-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(88px,1fr));gap:12px;}
.gift-card{
  background:linear-gradient(155deg,rgba(255,255,255,0.12),rgba(255,255,255,0.03));
  border:1px solid rgba(255,255,255,0.15);
  border-radius:16px;
  padding:8px 6px 10px;
  text-align:center;
  position:relative;
  overflow:hidden;
  backdrop-filter:blur(6px);
  cursor:pointer;
  transition:var(--transition);
}
.gift-card:hover{transform:translateY(-6px) scale(1.12);filter:brightness(1.25) saturate(1.3);}
.gift-card img{width:52px;height:52px;object-fit:contain;filter:drop-shadow(0 0 10px rgba(255,255,255,0.4));transition:var(--transition);}
.gift-card:hover img{transform:scale(1.15) rotate(6deg);}
.gift-name{margin-top:4px;font-size:12px;font-weight:700;letter-spacing:.5px;color:#e6f4ff;}
.gift-note{font-size:11px;opacity:.75;font-weight:600;}
.gift-note.accent{color:#ffd570;text-shadow:0 0 10px rgba(247,210,92,.55);}
.gift-hint{text-align:center;font-size:10px;color:var(--muted);opacity:.65;margin-top:6px;}
.cmd-move-hint{text-align:center;font-size:11px;color:#b7c5d7;opacity:.75;margin-top:10px;font-weight:600;}

/* Settings Panel (now pure open/close via class) */
#settings-panel{
  padding:10px 14px 18px;
  width:360px;
  max-height:70vh;
  overflow:auto;
  opacity:0;
  pointer-events:none;
  transition:var(--transition);
}
#settings-panel.open{
  opacity:1;
  pointer-events:auto;
}
#settings-panel .drag-bar{
  height:var(--drag-bar-height);
  display:flex;align-items:center;
  padding:0 12px;
  font-weight:900;font-size:14px;letter-spacing:1.2px;
  background:linear-gradient(90deg,rgba(0,242,234,0.25),rgba(255,0,128,0.25));
  border-radius:18px;
  cursor:grab;
  position:sticky;
  top:0;
  z-index:10;
}
.close-small{
  margin-left:auto;
  background:rgba(255,255,255,0.1);
  border:1px solid rgba(255,255,255,0.2);
  color:var(--txt);
  border-radius:8px;
  cursor:pointer;
  padding:4px 8px;
  font-size:12px;
  font-weight:700;
  transition:var(--transition);
}
.close-small:hover{filter:brightness(1.2);}

.settings-group{display:grid;gap:14px;margin-top:14px;}
.settings-group label{display:grid;gap:6px;font-size:14px;color:#c4d2e2;font-weight:600;}
.settings-group label.row{grid-auto-flow:column;justify-content:start;align-items:center;}
.settings-group input[type="range"],
.settings-group input[type="url"],
.settings-group input[type="password"],
.settings-group input[type="text"]{
  width:100%;background:#102033;border:1px solid #264162;color:var(--txt);padding:10px 12px;border-radius:12px;font-size:14px;font-weight:500;
}
.admin-actions{display:flex;flex-wrap:wrap;gap:10px;}
.btn{
  background:linear-gradient(145deg,#162941,#132131);
  border:1px solid #264060;
  color:var(--txt);
  padding:8px 14px;
  border-radius:12px;
  cursor:pointer;
  font-size:13px;
  font-weight:600;
  transition:var(--transition);
}
.btn:hover{filter:brightness(1.2);transform:translateY(-2px);}
.btn.alt{background:linear-gradient(145deg,#133a32,#0e2721);border-color:#1d574e;}
.btn.danger{background:linear-gradient(145deg,#3a1623,#2a0f18);border-color:#532534;}
.divider{border:0;height:1px;background:linear-gradient(90deg,rgba(0,242,234,0.35),rgba(255,0,128,0.35));margin:20px 0;border-radius:1px;}

.visually-hidden{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;}

#redeem-layer{position:absolute;inset:0;display:flex;align-items:flex-end;justify-content:center;pointer-events:none;padding-bottom:60px;z-index:15;}
.redeem-user-card{
  background:rgba(12,20,32,0.82);
  border:2px solid var(--cyan);
  border-radius:20px;
  padding:16px 22px;
  display:flex;gap:16px;align-items:center;
  font-size:16px;font-weight:600;
  backdrop-filter:blur(12px) saturate(160%);
  box-shadow:0 0 40px rgba(0,242,234,0.45),0 0 80px rgba(255,0,128,0.35);
  transform:translateY(24px) scale(.88);
  opacity:0;
}
.redeem-user-card.tier-t1{border-color:var(--bronze);}
.redeem-user-card.tier-t2{border-color:var(--silver);}
.redeem-user-card.tier-t3{border-color:var(--gold);}
.redeem-tier-label{
  margin-left:auto;
  background:linear-gradient(90deg,rgba(0,242,234,0.25),rgba(255,0,128,0.25));
  padding:6px 10px;
  border-radius:10px;
  font-size:13px;
  font-weight:800;
  letter-spacing:.7px;
}

#dev-panel{
  position:absolute;
  top:8px;
  left:50%;
  transform:translateX(-50%);
  background:var(--panel-bg);
  border:1px solid var(--panel-border);
  border-radius:18px;
  padding:4px 8px 10px;
  backdrop-filter:blur(12px) saturate(160%);
  box-shadow:0 0 20px rgba(0,242,234,0.35);
  pointer-events:auto;
  min-width:260px;
  z-index:30;
}
#dev-panel .drag-bar.small{
  height:30px;
  display:flex;
  align-items:center;
  cursor:grab;
  font-weight:800;
  padding:0 10px;
  font-size:13px;
  background:linear-gradient(90deg,rgba(0,242,234,0.25),rgba(255,0,128,0.25));
  border-radius:14px;
  margin:4px;
}
.dev-row{display:flex;flex-wrap:wrap;gap:6px;margin-top:6px;}
#dev-panel button{
  background:#162334;color:#cfe9ff;border:1px solid #28405f;
  border-radius:8px;padding:6px 10px;font-size:12px;font-weight:600;cursor:pointer;
  transition:var(--transition);
}
#dev-panel button:hover{background:#26455f;}
.dev-free{font-size:11px;display:flex;align-items:center;gap:4px;color:#eee;font-weight:600;padding:0 4px;}

#perf-panel{
  position:absolute;top:8px;right:8px;
  font:12px/1.2 system-ui,monospace;
  background:rgba(0,0,0,0.55);
  color:#d2faff;
  padding:8px 10px;
  border-radius:10px;
  backdrop-filter:blur(6px);
  box-shadow:0 0 14px rgba(0,255,255,0.4);
  z-index:40;
  pointer-events:none;
}

.resize-handle{
  position:absolute;
  width:var(--scale-handle-size);
  height:var(--scale-handle-size);
  bottom:6px;
  right:6px;
  background:linear-gradient(135deg,rgba(255,255,255,0.4),rgba(255,255,255,0.1));
  border:1px solid rgba(255,255,255,0.5);
  border-radius:4px;
  cursor:nwse-resize;
  box-shadow:0 0 8px rgba(255,255,255,0.35);
  display:flex;align-items:center;justify-content:center;
  font-size:10px;
  font-weight:700;
  color:#112033;
  user-select:none;
  backdrop-filter:blur(4px);
}

.drag-enabled{position:relative;}
.drag-enabled.dragging{outline:2px dashed var(--cyan);}

@media (max-width:1280px){
  #overlay{grid-template-columns:320px 1fr 260px;}
}
@media (max-width:1050px){
  #overlay{grid-template-columns:280px 1fr 250px;}
}
@media (max-width:900px){
  #overlay{
    grid-template-columns:1fr 250px;
    grid-template-rows:auto auto 1fr;
  }
  #leaderboard{grid-column:1 / span 2;order:3;}
  #right-stack{grid-column:2;grid-row:2;}
  #dev-panel{top:auto;bottom:12px;left:auto;transform:none;right:12px;}
}
@media (max-width:680px){
  #overlay{
    grid-template-columns:1fr;
    grid-template-rows:auto auto auto 1fr;
  }
  #right-stack{grid-column:1;grid-row:3;flex-direction:row;flex-wrap:wrap;}
  #commands-panel{flex:1 1 100%;max-width:100%;}
  #leaderboard{order:4;}
}